<!DOCTYPE html>

<html>

	<head>
		<meta charset="utf-8">
		<title>添加（省/直辖市）</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" href="../../../layuiadmin/layui/css/layui.css" media="all">
		<link rel="stylesheet" href="../../../layuiadmin/layui/icon/iconfont.css" media="all"/>
		<link rel="stylesheet" href="../../css/yqHtmlStyle.css">
		<link rel="stylesheet" type="text/css" href="../../css/qhs_reset.css" />
	</head>

	<body>
		<div class="layui-form" lay-filter="security_form_area" id="security_form_area" style="padding: 20px 30px 0 0;">	
			
			<div class="layui-form-item">
				<label class="layui-form-label">地区图片 : </label>
				<!--图片-->
				<input type="hidden" name="areaPicture" value="" id="personPhotoUrl" />
				<div class="layui-input-block updateuserimg">
					<img id="areaPicture" name="areaPicture" style="display: none;"/>
					<blockquote class="show_userimg" style="margin-top: 10px; width: 120px; display: inline-block;">
						<button type="button" class="layui-btn update_userimg" id="test1" lay-data="{accept: 'file',exts: 'jpg|png',size: '1024'}">
			  				<i class="layui-icon">&#xe67c;</i>上传图片
						</button>
					</blockquote>
				</div>
			</div>
			
			<div class="layui-form-item">
				<label class="layui-form-label">地区名称</label>
				<div class="layui-input-block">
					<input type="text" name="name" lay-verify="required" placeholder="请输入地区名称" autocomplete="off" class="layui-input" style="width: 100%;">
				</div>
			</div>
			
			<div class="layui-form-item">
				<label class="layui-form-label">地区简称</label>
				<div class="layui-input-block">
					<input type="text" name="shortName" lay-verify="required" placeholder="请输入简称" autocomplete="off" class="layui-input" style="width: 100%;">
				</div>
			</div>
			
			
			<div class="layui-form-item" id="zipCodeDiv">
				<label class="layui-form-label">行政代码</label>
				<div class="layui-input-block">
					<input type="text" name="zipCode" lay-verify="required" placeholder="请输入任意数字" 
						\autocomplete="off" class="layui-input" style="width: 100%;" onkeyup="this.value=this.value.replace(/\D/g,'')" 
						\onafterpaste="this.value=this.value.replace(/\D/g,'')">
				</div>
			</div>
			<div class="layui-form-item yqWidthPer75" style="width: 100%;">
				<label class="layui-form-label">经纬度 : </label>
				<div class="layui-input-block">
					<input type="text" name="lonlat" readonly="" lay-verify="required" placeholder="请输入经纬度" autocomplete="off" class="layui-input">
					<i class="layui-icon layui-icon-location  yqMargL10 yqCursoraCfff"  id="getLocationyq"></i>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">排序</label>
				<div class="layui-input-block">
					<input type="text" name="sort" lay-verify="number" placeholder="输入整数" autocomplete="off" class="layui-input" style="width: 100%;">
				</div>
			</div>
			
			
			<div class="layui-form-item">
				<input type="hidden" name="level"/>
				<input type="hidden" name="parentId" />
				<input type="hidden" name="photographyMapUrl" />
			</div>
			
			
			<div class="layui-form-item layui-hide">
				<button class="layui-btn" lay-submit lay-filter="security_submit_area" id="security_submit_area">提交</button>
			</div>
			
			<div class="layui-form-item">
				<label class="layui-form-label">简介</label>
				<div class="layui-input-block">
					<textarea name="introduce" placeholder="简介" class="layui-textarea" style="width: 100%;"></textarea>
				</div>
			</div>
		</div>

		<script src="../../../layuiadmin/layui/layui.js"></script>
		<script>
			layui.config({
				base: '../../../layuiadmin/' //静态资源所在路径
			}).extend({
				index: 'lib/index', //主入口模块
				iconPicker : 'iconPicker/iconPicker', //icon图标选择器
				yutons_sug : 'yutons-mods/yutons_sug'
			}).use(['index',  'qCommon', 'form', 'yutons_sug', 'iconPicker'], function() {
				var $ = layui.$,
					setter = layui.setter,
					qCommon = layui.qCommon,
					iconPicker = layui.iconPicker,
					yutons_sug = layui.yutons_sug,
					form = layui.form;
		            //初始化分组输入提示框
					yutons_sug.render({
						id: "groupCn", //设置容器唯一id
						type: 'sug', //设置输入框提示类型：sug-下拉框，sugTable-下拉表格
						url: "AddressM/addNewAddressInfo?groupCn=" //设置异步数据接口,url为必填项
					});
					
					// 获取经纬度/高度 的点击事件 弹出弹框  
					function getLonLat(elem) {
						var $elem = $(elem);
						var $latlon = $elem.prev();
	//					var $lon = $elem.parent().prev().prev().find('input');
						parent.layer.open({
							type: 2,
							title: '添加位置信息',
							content: '../newOne/getLonAndLat.html',
							area: ['1000px', '600px'],
							btn: ['确定'],
							yes: function(index, layero) {
								//获取经纬度的值
								var str = layero.find('iframe').contents().find("#map-content")[0].dataset.s;
								var strArr = str.split(",");
								var strlongitude = parseFloat(strArr[0]).toFixed(6),
									strlatitude = parseFloat(strArr[1]).toFixed(6);
								//赋值  security_form_area为form 的lay-filter
								var lonlat = strlongitude + ',' + strlatitude;
								$latlon.val(lonlat);
	//							$lat.val(strlatitude);
	//							$lon.val(strlongitude);
								parent.layer.close(index);
							}
						})
					}
					$("#getLocationyq").on("click", function() {
						var lon = "",lat = "";
						var yblonlat = $("input[name=lonlat]").val();
						if(yblonlat){
							lon = yblonlat.split(',')[0];
							lat = yblonlat.split(',')[1];
						}
						parent.layer.open({
							type: 2,
							title: '添加位置信息',
							content: '../../newOne/getLonAndLat.html?lon='+ lon + '&lat=' + lat + '&height=0',
							area: ['1000px', '600px'],
							btn: ['确定'],
							yes: function(index, layero) {
								//获取经纬度的值
								var str = layero.find('iframe').contents().find("#map-content")[0].dataset.s;
								var strArr = str.split(",");
								var strlongitude = parseFloat(strArr[0]).toFixed(6),
									strlatitude = parseFloat(strArr[1]).toFixed(6),
									strheight = parseFloat(strArr[2]).toFixed(2);
								var lonlat = strlongitude + ',' + strlatitude;
								//赋值  security_form_user为form 的lay-filter
								form.val("security_form_area", {
									"lonlat": lonlat,
									"height": strheight
								})
								parent.layer.close(index);
							}
						})
					});
					
					var data = {};
					data.operId = "#test1"; //按钮id
					data.previewId = "#demo2"; //预览id
					data.tipsId = "#demoText"; //提示id
					qCommon.uoloads(data, function(result, urls) {
						
					//设置上传图片样式
					$("#areaPicture").css({'display':'inline-block','width':'140px','height':'140px'});
					//上传图片时加载回显
					$("#personPhotoUrl").attr("value",result.data.src);
					//多次上传时覆盖上一张图片
					$("#areaPicture").attr("src", urls + result.data.src);
					
				});
			})
		</script>
	</body>

</html>