define([],function(){return function e(t,n,r){function i(l,a){if(!n[l]){if(!t[l]){var s="function"==typeof require&&require;if(!a&&s)return s(l,!0);if(o)return o(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[l]={exports:{}};t[l][0].call(f.exports,function(e){var n=t[l][1][e];return i(n||e)},f,f.exports,e,t,n,r)}return n[l].exports}for(var o="function"==typeof require&&require,l=0;l<r.length;l++)i(r[l]);return i}({1:[function(e,t,n){"use strict";t.exports=function(e,t){function n(e){var t=o.match(e);return t&&1===t.length&&0===t[0].index&&t[0].lastIndex===e.length?t[0].url:null}function r(e){var t=RegExp('<a\\shref="([^"<>]*)"(?:\\stitle="([^"<>]*)")?>',"i"),r=RegExp('<img\\s([^<>]*src="[^"<>]*"[^<>]*)\\s?\\/?>',"i");return e.replace(/<[^<>]*>?/gi,function(e){var i,o,s,g,m;if(/(^<->|^<-\s|^<3\s)/.test(e))return e;if(i=e.match(r)){var v=i[1];if(o=n(v.match(/src="([^"<>]*)"/i)[1]),s=(s=v.match(/alt="([^"<>]*)"/i))&&void 0!==s[1]?s[1]:"",g=(g=v.match(/title="([^"<>]*)"/i))&&void 0!==g[1]?g[1]:"",o&&/^https?:\/\//i.test(o))return""!==c?'<img src="'+o+'" alt="'+s+'" title="'+g+'" class="'+c+'">':'<img src="'+o+'" alt="'+s+'" title="'+g+'">'}return m=u.indexOf("a"),(i=e.match(t))&&(g=void 0!==i[2]?i[2]:"",(o=n(i[1]))&&/^(?:https?:\/\/|ftp:\/\/|mailto:|xmpp:)/i.test(o))?(f=!0,h[m]+=1,'<a href="'+o+'" title="'+g+'" target="_blank">'):(i=/<\/a>/i.test(e))?(f=!0,h[m]-=1,h[m]<0&&(p[m]=!0),"</a>"):(i=e.match(/<(br|hr)\s?\/?>/i))?"<"+i[1].toLowerCase()+">":(i=e.match(/<(\/?)(b|blockquote|code|em|h[1-6]|li|ol(?: start="\d+")?|p|pre|s|sub|sup|strong|ul)>/i))&&!/<\/ol start="\d+"/i.test(e)?(f=!0,m=u.indexOf(i[2].toLowerCase().split(" ")[0]),"/"===i[1]?h[m]-=1:h[m]+=1,h[m]<0&&(p[m]=!0),"<"+i[1]+i[2].toLowerCase()+">"):!0===a?"":l(e)})}var i,o=e.linkify,l=e.utils.escapeHtml,a=void 0!==(t=t||{}).removeUnknown&&t.removeUnknown,s=void 0!==t.removeUnbalanced&&t.removeUnbalanced,c=void 0!==t.imageClass?t.imageClass:"",f=!1,u=["a","b","blockquote","code","em","h1","h2","h3","h4","h5","h6","li","ol","p","pre","s","sub","sup","strong","ul"],h=new Array(u.length),p=new Array(u.length);for(i=0;i<u.length;i++)h[i]=0;for(i=0;i<u.length;i++)p[i]=!1;e.core.ruler.after("linkify","sanitize_inline",function(e){var t,n,o;for(i=0;i<u.length;i++)h[i]=0;for(i=0;i<u.length;i++)p[i]=!1;for(f=!1,n=0;n<e.tokens.length;n++)if("html_block"===e.tokens[n].type&&(e.tokens[n].content=r(e.tokens[n].content)),"inline"===e.tokens[n].type)for(o=e.tokens[n].children,t=0;t<o.length;t++)"html_inline"===o[t].type&&(o[t].content=r(o[t].content))}),e.core.ruler.after("sanitize_inline","sanitize_balance",function(e){function t(e,t){var n,r;return n="a"===t?RegExp('<a href="[^"<>]*" title="[^"<>]*" target="_blank">',"g"):"ol"===t?/<ol(?: start="\d+")?>/g:RegExp("<"+t+">","g"),r=RegExp("</"+t+">","g"),e=!0===s?(e=e.replace(n,"")).replace(r,""):(e=e.replace(n,function(e){return l(e)})).replace(r,function(e){return l(e)})}function n(e){var n;for(n=0;n<u.length;n++)!0===p[n]&&(e=t(e,u[n]));return e}if(!1!==f){var r,o;for(i=0;i<u.length;i++)0!==h[i]&&(p[i]=!0);for(r=0;r<e.tokens.length;r++)if("html_block"!==e.tokens[r].type){if("inline"===e.tokens[r].type)for(o=e.tokens[r].children,i=0;i<o.length;i++)"html_inline"===o[i].type&&(o[i].content=n(o[i].content))}else e.tokens[r].content=n(e.tokens[r].content)}})}},{}]},{},[1])(1)});